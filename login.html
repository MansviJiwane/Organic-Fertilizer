<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login / Register - Ecogaon</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root { --green:#2E8B57; --earth:#f4fff4; }
    *{margin:0;padding:0;box-sizing:border-box;}
    body{
      font-family:'Poppins',sans-serif;
      background:linear-gradient(135deg,#f0fff4,#e6ffe6);
      min-height:100vh;display:flex;align-items:center;justify-content:center;
      background-image:url('https://foodtank.com/wp-content/uploads/2018/04/Food-Tank-Climate-Change-Crowd-Source.jpg');
      background-repeat:no-repeat;background-position:center;background-size:cover;
    }
    .container{
      background:rgba(255,255,255,0.95);
      border-radius:20px;
      padding:3rem;
      box-shadow:0 20px 40px rgba(0,0,0,0.1);
      width:100%;max-width:500px;margin:2rem;
    }
    .header{text-align:center;margin-bottom:2rem;}
    .header h1{color:var(--green);font-size:2.5rem;margin-bottom:0.5rem;}
    .header p{color:#666;font-size:1.1rem;}
    .form-tabs{display:flex;margin-bottom:2rem;background:var(--earth);border-radius:10px;padding:0.5rem;}
    .tab{flex:1;padding:1rem;text-align:center;border-radius:8px;cursor:pointer;transition:all 0.3s ease;font-weight:600;}
    .tab.active{background:var(--green);color:white;}
    .form-group{margin-bottom:1.5rem;}
    .form-group label{display:block;margin-bottom:0.5rem;color:var(--green);font-weight:600;}
    .form-group input,.form-group select{
      width:100%;padding:1rem;border:2px solid #e0e0e0;border-radius:10px;font-size:1rem;
    }
    .submit-btn{
      width:100%;background:var(--green);color:white;padding:1rem;border:none;border-radius:10px;
      font-size:1.1rem;font-weight:600;cursor:pointer;transition:all 0.3s ease;
    }
    .submit-btn:hover{background:#228B22;transform:translateY(-2px);}
    .alert{
      padding:1rem;border-radius:10px;margin-bottom:1rem;display:none;
    }
    .alert.success{background:#d4edda;color:#155724;border:1px solid #c3e6cb;}
    .alert.error{background:#f8d7da;color:#721c24;border:1px solid #f5c6cb;}
  </style>
</head>
<body>

<div class="container">
  <div class="header">
    <h1>ðŸŒ± Ecogaon</h1>
    <p>Login or Register to start your eco journey</p>
  </div>

  <div class="form-tabs">
    <div class="tab active" onclick="switchTab(event,'login')">Login</div>
    <div class="tab" onclick="switchTab(event,'register')">Register</div>
  </div>

  <div id="alert" class="alert"></div>

  <!-- LOGIN FORM -->
  <form id="loginForm" onsubmit="handleLogin(event)">
    <div class="form-group">
      <label for="loginPhone">Phone Number</label>
      <input type="tel" id="loginPhone" placeholder="Enter your number" required>
    </div>
    <button type="submit" class="submit-btn" id="loginBtn">Login to Ecowallet</button>
  </form>

  <!-- REGISTER FORM -->
  <form id="registerForm" onsubmit="handleRegister(event)" style="display:none;">
    <div class="form-group">
      <label for="regName">Full Name</label>
      <input type="text" id="regName" placeholder="Enter your name" required>
    </div>
    <div class="form-group">
      <label for="regPhone">Phone Number</label>
      <input type="tel" id="regPhone" placeholder="Enter your number" required>
    </div>
    <div class="form-group">
      <label for="regRole">Role</label>
      <select id="regRole">
        <option value="household">Household</option>
        <option value="farmer">Farmer</option>
        <option value="buyer">Buyer</option>
        <option value="krushikendra">Krushikendra</option>
        <option value="admin">Admin</option>
      </select>
    </div>
    <button type="submit" class="submit-btn" id="registerBtn">Register Now</button>
  </form>
</div>

<script>
function switchTab(event, tab) {
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  event.currentTarget.classList.add('active');
  document.getElementById('loginForm').style.display = tab === 'login' ? 'block' : 'none';
  document.getElementById('registerForm').style.display = tab === 'register' ? 'block' : 'none';
  hideAlert();
}

function showAlert(msg, type){
  const alert=document.getElementById('alert');
  alert.textContent=msg;
  alert.className='alert '+type;
  alert.style.display='block';
  setTimeout(()=>alert.style.display='none',3000);
}

function hideAlert(){
  const alert=document.getElementById('alert');
  alert.style.display='none';
}

function handleRegister(e){
  e.preventDefault();
  const name=document.getElementById('regName').value.trim();
  const phone=document.getElementById('regPhone').value.trim();
  const role=document.getElementById('regRole').value;
  const btn=document.getElementById('registerBtn');

  if(!name || name.length<2){showAlert('Please enter a valid name','error');return;}
  if(!/^[0-9]{10}$/.test(phone)){showAlert('Enter valid 10 digit number','error');return;}

  btn.disabled=true;
  btn.textContent='Registering...';

  let users=JSON.parse(localStorage.getItem('ecogaon_users'))||[];
  if(users.find(u=>u.phone===phone)){
    showAlert('User already exists, please login.','error');
    btn.disabled=false;btn.textContent='Register Now';return;
  }

  const newUser={name,phone,role};
  users.push(newUser);
  localStorage.setItem('ecogaon_users',JSON.stringify(users));

  showAlert('Registered successfully! Redirecting...','success');
  setTimeout(()=>{
    document.querySelector('.tab:nth-child(1)').click();
    document.getElementById('loginPhone').value=phone;
  },1500);

  btn.disabled=false;
  btn.textContent='Register Now';
}

function handleLogin(e){
  e.preventDefault();
  const phone=document.getElementById('loginPhone').value.trim();
  const btn=document.getElementById('loginBtn');
  btn.disabled=true;btn.textContent='Logging in...';

  let users=JSON.parse(localStorage.getItem('ecogaon_users'))||[];
  const user=users.find(u=>u.phone===phone);
  if(user){
    localStorage.setItem('ecogaon_user',JSON.stringify(user));
    showAlert('Login successful! Redirecting...','success');
    setTimeout(()=>{window.location.href='./ecowallet.html';},1500);
  }else{
    showAlert('User not found! Please register first.','error');
  }

  btn.disabled=false;btn.textContent='Login to Ecowallet';
}

window.addEventListener('DOMContentLoaded',()=>{
  const loggedUser=localStorage.getItem('ecogaon_user');
  if(loggedUser){window.location.href='./ecowallet.html';}
});
</script>
</body>
</html>
